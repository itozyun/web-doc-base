<!DOCTYPE html>
<html lang="ja" xmlns:v="urn:schemas-microsoft-com:vml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Test Dynamic Script | web-doc-base</title>
<meta name="msapplication-tap-highlight" content="no">
<meta name="HandheldFriendly" content="true">
<meta name="mobileoptimized" content="0">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta http-equiv="imagetoolbar" content="no">
<meta name="format-detection" content="telephone=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="viewport" content="width=device-width,target-densitydpi=medium-dpi,initial-scale=1,minimum-scale=1,shrink-to-fit=no">
<style>
    #output {margin : 1em; padding : 1em; border : 2px solid #ccc;}
    #output p {margin:0; line-height:1;}
</style>
<script>
window.onerror = function(a){
    alert( a );
};

var SRC_DYNAMIC_SCRIPT = './dynamic-script';

function createScriptElement(){
    var script = document.createElement('script');

    script.src = SRC_DYNAMIC_SCRIPT + '-1.js?ts=' + ( + new Date );
    document.body.appendChild(script);
};

function changeSourceAttributeOfScript(){
    var scripts = document.scripts || document.getElementsByTagName('script');

    scripts[0].src = SRC_DYNAMIC_SCRIPT + '-2.js?ts=' + ( + new Date );
};

var SOURCE = '(function(){' +
    'var elm = document.getElementById("output");' +
    'elm.innerHTML = "<p>[##] Dynamic Inline Script. " + (new Date()).toLocaleString() + "</p>" + elm.innerHTML;' +
'})()';

function dynamicInlineScript(){
    var script = document.createElement('script');

    script.appendChild(document.createTextNode(SOURCE.split('##').join('3-1')));
    document.body.appendChild(script);
};

function dynamicInlineScript_innerHTML(){
    var script = document.createElement('script');

    script.innerHTML = SOURCE.split('##').join('3-2');
    document.body.appendChild(script);
};

function dynamicInlineScript_innerText(){
    var script = document.createElement('script');

    script.innerText = SOURCE.split('##').join('3-3');
    document.body.appendChild(script);
};

function dynamicInlineScript_textContent(){
    var script = document.createElement('script');

    script.textContent = SOURCE.split('##').join('3-4');
    document.body.appendChild(script);
};

function dynamicInlineScript_text(){
    var script = document.createElement('script');

    script.text = SOURCE.split('##').join('3-5');
    document.body.appendChild(script);
};

function useInnerHTMLHack(){
    var div = document.createElement('div');

    div.innerHTML = '&nbsp;<script defer="defer">' + SOURCE.split('##').join('3-6') + '<' + '/script>';
    document.body.appendChild(div);
};
// iframe + jsonp
</script>
</head>
<body size="1">
<a href="https://github.com/itozyun/web-doc-base/">github</a>,
<a href="../">top</a>,
<a href="clearfix.html">clearfix のテスト</a>,
<a href="cssGeneratedContent.html">疑似要素のテスト</a>,
<a href="cssom.html">CSSOM のテスト</a>,
動的 Script のテスト,
<a href="importHack.html">import のテスト</a>,
<a href="check-image-loading.html">Check Image loading</a>,
<a href="icon.html">アイコンのテスト</a>,
<a href="richlink.html">RichLink のテスト</a>,
<a href="form.html">フォーム部品の実装状況</a>,
<a href="dynamic-pseudo-classes.html">フォーム部品のスタイリングのテスト</a>,
<a href="attr-selectors.html">属性セレクタのテスト</a>
<hr>
<h1>動的 Script のテスト</h1>
<p><input type="button" onclick="createScriptElement();" value="1. createScriptElement">,
<input type="button" onclick="changeSourceAttributeOfScript();" value="2. changeSourceAttributeOfScript">,
<input type="button" onclick="dynamicInlineScript();" value="3-1. dynamicInlineScript createTextNode()">,
<input type="button" onclick="dynamicInlineScript_innerHTML();" value="3-2. dynamicInlineScript .innerHTML">,
<input type="button" onclick="dynamicInlineScript_innerText();" value="3-3. dynamicInlineScript .innerText">,
<input type="button" onclick="dynamicInlineScript_textContent();" value="3-4. dynamicInlineScript .textContent">,
<input type="button" onclick="dynamicInlineScript_text();" value="3-5. dynamicInlineScript .text">,
<input type="button" onclick="useInnerHTMLHack();" value="3-6. dynamicInlineScript hack">
<div id="output"></div>
<h2>Links</h2>
<ul>
<li><a href="https://web.archive.org/web/20040325075516/http://www.hikksworld.com/loadJSFiles/">Dynamically Loading JS Files</a>
<li><a href="https://fdays.blogspot.com/2010/05/javascript-script.html">JavaScriptによって動的に script要素を追加する場合のブラウザごとの挙動の違い</a>
<li><a href="https://shogo4405.hatenadiary.com/entry/20061207/1165479339">innerHTMLでscriptする</a>
<li><a href="https://michigawi.blogspot.com/2013/02/internetexplorerjavascriptinnerhtml.html">Internet ExplorerでJavaScriptの動的実行</a>
<li><a href="https://support.microsoft.com/ja-jp/topic/iframe-%E8%A6%81%E7%B4%A0%E5%86%85%E3%81%AB%E5%8B%95%E7%9A%84%E3%81%AB-script-%E8%A6%81%E7%B4%A0%E3%82%92%E5%87%BA%E5%8A%9B%E3%81%99%E3%82%8B%E3%81%A8-internet-explorer-%E3%81%8C%E5%BF%9C%E7%AD%94%E3%81%AA%E3%81%97%E3%81%AB%E3%81%AA%E3%82%8B%E5%A0%B4%E5%90%88%E3%81%8C%E3%81%82%E3%82%8B-5a38b82f-e2e1-e78a-0913-823a8962a601">iframe 要素内に動的に script 要素を出力すると Internet Explorer が応答なしになる場合がある</a>
</ul>
</body>
</html>