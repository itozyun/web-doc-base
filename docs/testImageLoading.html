<!DOCTYPE html><html lang="ja" xmlns:v="urn:schemas-microsoft-com:vml"><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Test Image loading | web-doc-base</title>
<meta name="msapplication-tap-highlight" content="no">
<meta name="HandheldFriendly" content="true">
<meta name="mobileoptimized" content="0">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta http-equiv="imagetoolbar" content="no">
<meta name="format-detection" content="telephone=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="viewport" content="width=device-width,target-densitydpi=medium-dpi,initial-scale=1,minimum-scale=1,shrink-to-fit=no">
<style>
    textarea { display : block; width : 100% }
</style>
<script>ua=[];ua.conpare=function(D,g){var w=0,q,P;D=(D+"").split(".");g=(g+"").split(".");var t=D.length;for(q=g.length;"0"===D[t-1];)--t;for(;"0"===g[q-1];)--q;for(P=t<q?t:q;w<P;++w){var Q=D[w]-0;var G=g[w]-0;if(Q!==G)return Q>G?1:-1}return t>q?1:t===q?0:-1};(function(D,g,w,q,P,t,Q,G){function W(f,p,n){n=t(f.split(p)[1]);return 0<=n?n:0}function b(f,p){return 0<=f.indexOf(p)}function ra(f){return b(f,"Linux armv")||b(f,"Linux aarch")||b(f,"Linux i686")||b(f,"Linux x86_64")}function X(f,p){for(var n in p)if(n===f)return!0}function c(f,p){var n="",H=-1,Y;if(f=f.split(p)[1]){for(;Y=f.charCodeAt(++H);)if(48<=Y&&57>=Y||46===Y)n+=f.charAt(H);else break;for(H=n.length;H;)if(46===n.charCodeAt(--H))n=n.substr(0,H);else break}return n}function sa(){for(var f=arguments,
p=1,n=f[0],H;p<f.length;++p)0>ta(n,H=f[p])&&(n=H);return n}function va(f){return f===f+""?f:f===f-0?""+f:f.min&&f.max?f.min+"~"+f.max:f.min?f.min+"~":"~"+f.max}function da(f,p){p&&(J&&(J+=","),J+=f+p)}var ta=D.conpare,a=q.userAgent,r=q.appVersion,ea=t(r)||0,k=q.platform,fa=w.documentElement,wa=fa&&fa.style,ha=w.documentMode,ia=P.width,ja=P.height,xa=g.HTMLAudioElement,ya=g.performance,za=g.Int8Array,Qa=g.ontouchstart!==G,M=c(r,"Version/")||c(a,"Version/"),Aa=g.operamini,N=!Aa&&g.opera,Ra=N&&(N.version&&
"function"===typeof N.version?N.version():sa(c(a,"Opera "),M,ea)),Ba=g.opr,R=!N&&(w.all||ha),K=R&&(ha?ha:g.XMLHttpRequest?w.getElementsByTagName?7:4:w.compatMode?6:(0).toFixed?5.5:g.attachEvent?5:4),ka=!R&&fa.msContentZoomFactor,Z=!ka&&g.chrome,O=!R&&function(f){for(f in wa)if(0===f.indexOf("Moz"))return!0}(),la=b(a,"UCWEB"),Sa=la&&c(a," U2/"),Ta=la&&c(a,"; wds "),ma=c(a.split("_").join("."),"; iPh OS "),Ua=c(a,"; Adr "),Ca=b(r,"YJApp-ANDROID"),A=b(k,"Android")||O&&b(r,"Android")||Ca,u=c(k,"Android ")||
c(r,"Android ")||c(a,"Android ")||Ua,na=b(k,"Linux"),Da="MacIntel"===k&&q.standalone!==G,oa=O&&c(a,"Goanna/"),E=!oa&&O&&(c(a,"rv:")||c(a.substr(a.indexOf(") Gecko/")-11),"; ")),Va=c(a,"Firefox/"),Wa=c(a,"Opera/"),Xa=g.FNRBrowser,I=W(a,"AppleWebKit/"),S=c(a,"Chrome/"),Ea=c(a,"OPR/"),Ya=c(r,"KHTML/"),Za=c(a.toLowerCase(),"iris");c(a,"FxiOS/");c(a,"CriOS/");c(a,"EdgiOS/");var $a=c(a,"Silk/"),T=W(a,"SamsungBrowser/"),Fa=!T&&function(){for(var f="GT-I9300 GT-I9305 SHV-E210 SGH-T999L SGH-I747 SGH-N064 SC-06D SGH-N035 SC-03E SCH-J021 SCL21 SCH-R530 SCH-I535 SCH-S960L SCH-S968C GT-I9308 SCH-I939 SHV-E210S GT-I8160 GT-I8260 GT-I8262 SM-G350 SM-G352 SM-G386F SM-G386T1GT-N7000 GT-N7005 SHV-E160 SC-05D SGH-N054 SGH-I717 SGH-T879 GT-I9220 GT-I9228 SCH-I889 GT-N7100 GT-N7105 SCH-I605 SCH-R950 SGH-I317 SGH-T889 SPH-L900 SCH-N719 GT-N7102 GT-N7108 SGH-N025 SC-02E SHV-E250 GT-N5100 GT-N5110 GT-N5120 GT-N8000 GT-N8005 GT-N8010 GT-N8013 GT-N8020 GT-I9100 GT-I9108 GT-I9210 SGH-I777 SGH-I757M SGH-I727 SGH-I927 SGH-T989 SHW-M250 SPH-D710 ISW11SC SC-02C SCH-R760 SCH-I929 GT-I9105 GT-I8190 GT-I8200 SM-G730A GT-P3100 GT-P3110 GT-P3113 SCH-I705 GT-P5100 GT-P5110 GT-P5113 SCH-I915 SM-G3508 SM-G3509 GT-S7580 GT-S7582 GT-S6310 GT-S6312 GT-S6313T".split(" "),
p,n=f.length;p=f[--n];)if(b(a,p))return 2>t(M)?M:.9;f="SC-02F SGH-N075 GT-S7270 GT-S7272 GT-S7275R GT-I9150 GT-I9152 GT-I9200 GT-I9205 GT-I9500 GT-I9506 SC-04E SGH-N045 GT-I9190 GT-I9192 GT-I9295 GT-I9197 GT-I9198 SGH-I257M SCH-I435 GT-I8666 GT-I8552 GT-I8558 SHV-E500S/L GT-18552B SM-N900 N9000 N9002 SC-01F SCL22 SM-G7100 SM-G7102 SM-G7105 SM-N750 SM-P600 SM-P601 SM-P605 GT-I9301I GT-I9300RWI SGH-T399 SM-P900 SM-P901 SM-P90 SM-P905 GT-I9295 SGH-I537 SHV-E330S GT-I9507V GT-I9505 GT-I9515 SGH-I337 SM-T230 SM-T231 SM-T235 SM-T237 403SC SM-T330NU SM-T331NU SM-T337V SM-T530 SM-T531 SM-T535 M-T320 SM-T321 SM-T325 SM-T520 SM-T525 SM-T900 SM-T905 SM-T700 SM-T705 SM-T707V SM-T800 SM-T805 SM-T807 SM-A300 SM-A5000 SM-A5009 SM-A500F SM-A500F1 SM-A500FQ SM-A500FU SM-A500G SM-A500H SM-A500HQ SM-A500K SM-G850 SM-C115 SM-C111 SM-G750F SM-G7508 SM-G7508Q SM-G750H GT-I9301I SM-900 SC-04F SCL23 SM-G906S SM-G906K SM-G906L SM-G870A SM-N915 SC-02G SM-800".split(" ");
for(n=f.length;p=f[--n];)if(b(a,p))return M}(),Ga=Z&&534.3>=I,Ha=ra(k),ab=Ha&&!b(a,k)&&ra(a),Ia=Qa&&(I||O)&&ab||!u&&Ca,bb=!!g.ReactNativeWebView,cb=Ha&&function(f){for(f in g)if(0===f.indexOf("SlexAPI_"))return!0}(),Ja=g.puffinDevice,aa=Ja&&Ja.clientInfo,U=aa&&"iOS"===aa.os&&aa.osVersion,ba=U&&aa.model,pa=!K&&w.registerElement,db=!K&&w.execCommand,eb=na&&pa&&"11.0.696.34"===S,fb=g._firefoxTV_playbackStateObserverJava,Ka=W(a,"diordnA "),y,l;if("Nitro"===k)var e="NDS";else if("Nintendo DSi"===k){e=
"NDSi";var d=Wa}else if("New Nintendo 3DS"===k||b(a,"iPhone OS 6_0")&&320===ia&&240===ja)e="New3DS",d=c(a,"NintendoBrowser/");else if("Nintendo 3DS"===k)e="N3DS",d=c(a,"Version/"),I=535;else if("Nintendo Swicth"===k)e="Switch",d=c(r,"NintendoBrowser/");else if("Nintendo WiiU"===k)e="WiiU",d=c(r,"NintendoBrowser/"),I=c(r,"AppleWebKit/");else if("Nintendo Wii"===k)e="Wii",d=c(a,"Wii; U; ; ");else if(l=c(a,"PlayStation Vita "))e="PSVita",d=l;else if(l=c(a,"(PlayStation Portable); ")){e="PSP";d=l;var La=
3.3}else if(l=c(a,"PLAYSTATION 3; ")||c(a,"PLAYSTATION 3 ")){if(e="PS3",d=l,0>ta("4.10",l)){var h="Sony";var m=l}}else if(b(a,"Xbox One"))e="XboxOne",d=1;else if(b(a,"Xbox"))e="Xbox360",d=1;else if(2===ea&&b(a,"Sony/COM2/")){e="Mylo";d=2;La=3.4;var ca=!0}else if(0===k.indexOf("iP")||ma||U||Da){if(U)switch(d=U,ba.substr(0,4)){case "iPho":var B="iPhone";c(ba,B);var z=!0;break;case "iPad":B="iPad";c(ba,B);var x=!0;break;case "iPod":B="iPod";c(ba,B);var Ma=!0}else{ma?d=ma:(d=c(r.split("_").join("."),
"OS "),X("isSecureContext",g),X("enableWebGL",g),X("sameOrigin",g));d||(y=!0);if(!d||Xa)d=g.PointerEvent?13:g.HTMLDataListElement?12.2:Array.prototype.flat?12:q.sendBeacon?11.3:g.WebAssembly?11.2:g.HTMLMeterElement?10.3:g.Proxy?10.2:g.HTMLPictureElement?9.3:Q.isNaN?9.2:g.SharedWorker?ya&&ya.now?8:8.4:db?7.1:g.webkitURL?6.1:g.Worker?5.1:za?4.3:xa?4.1:3.2;var C=ia===1.5*ja||1.5*ia===ja;0===k.indexOf("iPhone")?(B="iPhone",z=!0):0===k.indexOf("iPad")||Da?(B="iPad",x=!0):0===k.indexOf("iPod")&&(B="iPod",
Ma=!0)}h=!U&&(q.standalone||(x||12>d)&&X("webkitFullscreenEnabled",w)||11<=d&&13>d&&q.mediaDevices)?"SafariMobile":"iOSWebView";e="iOS";m=d}else if(b(a,"Kobo"))e="Kobo",h="AOSP",m=2.2,A=!0;else if(b(a,"EBRD"))e="SonyReader",h="AOSP",m=2.2;else if(l=c(a,"CrOS x86_64 ")||c(a,"CrOS aarch64 ")||c(a,"CrOS i686 ")||c(a,"CrOS armv7l "))e="ChromeOS",d=l;else if(g.onmoztimechange!==G)e="FirefoxOS",d=18.1>E?"1.0.1":19>E?1.1:27>E?1.2:29>E?1.3:31>E?1.4:33>E?2:35>E?2.1:38>E?2.2:45>E?2.5:2.6,b(a,"Mobile")?z=!0:
b(a,"Tablet")?x=!0:b(a,"TV");else if(g.palmGetResource)e="WebOS",d=c(a,"webOS/")||c(a,"WEBOS")||c(a,"hpwOS/"),b(a,"webOS.TV")||b(a,"/SmartTV")||(z=!0);else if(l=c(a,"Tizen "))e="Tizen",d=l,h="Samsung",m=T,z=!0;else if(l=c(a,"Windows Phone ")||c(r,"Windows Phone OS ")||Ta)e="WindowsPhone",d=l,z=!0;else if(ka&&"ARM"===k)e="WindowsPhone",d=10,y=z=!0;else if(R&&b(r,"ZuneWP"))e="WindowsPhone",d=11===K?8.1:10===K?8:9===K?7.5:7===K?7:"?",y=z=!0;else if(b(a,"FOMA;"))e="FeaturePhone",z=!0;else if(b(a,"SoftBank;"))e=
"FeaturePhone",z=!0;else if(b(a,"KFMUWI")){var F=!0;d=6.3;var v=x=!0}else if(b(a,"KFKAWI"))F=!0,d=6,v=x=!0;else if(b(a,"KFSUWI")||b(a,"KFAUWI")||b(a,"KFDOWI"))F=!0,d=5,v=x=!0;else if(b(a,"KFGIWI"))F=!0,d=5,v=x=!0;else if(b(a,"KFARWI")||b(a,"KFSAWA")||b(a,"KFSAWI"))F=!0,d=5<=t(u)?5:4,v=x=!0;else if(b(a,"KFSOWI")||b(a,"KFTHWA")||b(a,"KFTHWI")||b(a,"KFAPWA")||b(a,"KFAPWI"))F=!0,d=3,v=x=!0;else if(b(a,"KFOT")||b(a,"KFTT")||b(a,"KFJWA")||b(a,"KFJWI"))F=!0,d=2,v=x=!0;else if(b(a,"Kindle Fire"))F=!0,d=1,
v=x=!0;else if(l=c(a,"Kindle/"))e="Kindle",d=l,h="AOSP",m=2.2;else if(fb)F=!0,d=u||Ka,v=!0,y=Ka;else if(b(a,"AmazonWebAppPlatform")||b(a,"; AFT"))F=!0,d=u,v=!0;else if(b(a,"MeeGo"))e="MeeGo";else if(b(a,"Maemo"))e="Maemo";else if(0===a.indexOf("Windows Mobile;")||Za)e="WindowsMobile",ca=!0;else if("WinCE"===k)e="WindowsCE",ca=!0;else if(0===k.indexOf("Win"))e="Win16"===k?"Win16":"Win32"===k?"Win32":"Win64"===k?"Win64":"",d=c(a,"Windows NT ")||c(a,"Windows ");else if(0===k.indexOf("Mac")){e="Mac68K"===
k?"Mac68K":"MacPowerPC"===k||"MacPPC"===k?"MacPPC":"MacIntel"===k?"MacIntel":"";if(l=c(a.split("_").join("."),"Mac OS X "))d=l;var gb=!0}else if(b(a,"BlackBerry")||b(a,"BB10"))e="BlackBerry",d=M,z=!0;else if(b(a,"SunOS")||b(a,"Sun Solaris"))e="SunOS";else if(b(a,"FreeBSD"))e="FreeBSD";else if(b(a,"OpenBSD"))e="OpenBSD";else if(b(a,"NetBSD"))e="NetBSD";else if(A&&O)b(a,"Android 4.4;")?C={min:2.3}:4<=t(u)?C=u:C={min:2.2},d=C,Ia&&(y=!0);else if(A&&N)u?C=u:(C={min:1.6},y=!0),d=C,b(a,"Tablet")?x=!0:z=
!0;else if(u)d=u,A=!0;else if(na&&Ia||bb||cb){var L=!0;T?C={min:4.4}:Z&&!Ga||Ba||Ea?C={min:4}:(C=u=wa.touchAction!==G?{min:5}:pa?4.4:za?q.connection?g.searchBoxJavaBridge_||Z?Q.isNaN?4.1:4:4.2:4.4:534<=I?3:533<=I?xa?2.3:2.2:530<=I?2:1.5,Fa&&(h="Samsung",m=Fa));d=C;A=!0}else eb?(d={min:5},L=A=!0):na&&(b(a,"Ubuntu")?e="Ubuntu":(l=c(a,"Mint/"))?(e="Mint",d=l):(l=c(a,"Fedora/"))?(e="Fedora",d=l):e=b(a,"Gentoo")?"Gento":"Linux");F||A&&L&&$a?e="FireOS":A&&(e=e||"Android");h||(v=v||A,N?(h=v||ca||z||x?"PrestoMobile":
"Presto",m=Ra):R?(C=W(r,"Trident/")+4,h=ca||z||x||Ma?"TridentMobile":gb&&5<=K?"Tasman":"Trident",m=K):ka?(h="WindowsPhone"===e?"EdgeMobile":"EdgeHTML",m=c(r,"Edge/")):oa?(h="Goanna",m=oa):O?(h=v?"Fennec":"Gecko",m=E||Va):T?(h="Samsung",m=T,L&&(y=!0)):(l=La||c(a,"NetFront/"))?(h="NetFront",m=l):(l=c(a,"iCab"))?(h="iCab",m=l):(l=sa(c(a,"Opera Mini/"),c(a,"Opera Mobi/"))||Aa&&M)?(h="OperaMini",m=l,e||(b(a,"iPhone")?B="iPhone":b(a,"iPad")?B="iPad":b(a,"iPod")&&(B="iPod"),B&&(e="iOS"))):la?(h="UCWEB",
m=Sa):Ya?(h="KHTML",m=ea):A&&Ga?(h="AOSP",m=u,L&&(y=!0)):Z||Ba||Ea?(h=v?"ChromiumMobile":"Chromium",m=S,L&&(y=!0)):A&&pa?(h="ChromeWebView",m=5>t(u)?u:S,L&&(y=!0)):A&&(M||L)?(h="AOSP",m=u,L&&(y=!0)):S?(h=v?"ChromiumMobile":"Chromium",m=S):I&&(h="WebKit",m=I));c(r,"OPT/")&&(y=y||!b(r,"Mobile/"));e&&(D.PLATFORM=e,d&&(D.PLATFORM_VERSION=va(d)));h&&(D.ENGINE=h,m&&(D.ENGINE_VERSION=va(m)));var J="",V,Na="SafariMobile"===h||"iOSWebView"===h?t(m):G,Oa="AOSP"===h?t(m):G;if("N3DS"===e)var Pa=320;else if("New3DS"===
e){Pa=320;var qa=V=1}else if(5>Na)V=1,J="maximum-scale=1";else if(6>Na)qa=V=1;else if(Oa){var hb=!0;J="target-densitydpi=medium-dpi";3>Oa?J+=",user-scalable=no":qa=V=1}da("width=",hb?"device-width":Pa);da("initial-scale=",qa);da("minimum-scale=",V);J&&w.getElementsByName("viewport")[0].setAttribute("content",J)})(ua,window,document,navigator,screen,parseFloat,Number,void 0);
</script>
<script>
var trident = ua.Trident || ua.TridentMobile;

function test( url, timeout, delay ){
    var textarea = document.output || window.output || document.getElementById( 'output' ),
        result = '',
        img = new Image(), tick = 0;

    function log( str ){
        result += str;
        window.status = result;
        if( trident < 5 || 5.5 <= trident || !trident ){
            textarea.value = result;
        } else {
            textarea.innerHTML = result;
        };
    };

    img.onabort = function(){
        log( "ABORT!" );
        img.complete && log( "[+comp]" );
    };

    img.onerror = function(){
        log( "ERROR!" );
        img.complete && log( "[+comp]" );
    };

    img.onload  = function(){
        log( "LOAD!" );
        img.complete && log( "[+comp]" );
    };

    img.src = url;
    log( "[" + url + "]" );

    if( timeout ){
        setTimeout(
            function(){
                log( "." );
                img.complete && log( "[+comp2]" );
                if( img.complete || timeout < ( tick += delay ) ){
                    log( img.complete ? "c" : "t" );
                    log( "[w:" + img.width + "]" );
                    log( "[natural:" + img.naturalWidth + "]" );
                } else {
                    setTimeout( arguments.callee, delay );
                };
            }, 0
        );
    };
};

if( trident < 5 || ua.Tasman ){
    var __setTimeout = setTimeout,
        __callback = function(){ __actual(); },
        __actual;

    setTimeout = function( callback, delay ){
        __setTimeout( '__callback', delay );
        __actual = callback;
    };
};
</script>
</head>
<body size="1">
<a href="https://github.com/itozyun/web-doc-base/">github</a>,
<a href="clearfix.html">clearfix のテスト</a>,
<a href="cssGeneratedContent.html">疑似要素のテスト</a>,
<a href="getInlineJs.html">Web 文書用のインライン js</a>,
<a href="test.cssom.html">CSSOM のテスト</a>,
<a href="importHack.html">import のテスト</a>,
Test Image loading,
<a href="test.icon.html">アイコンのテスト</a>,
<a href="richlink.html">RichLink のテスト</a>
<hr>
<h1>Test Image loading</h1>
<button onclick="test( 'imageSprite/taichi.png', 1000, 8 )">load test</button>
<button onclick="test( 'imageSprite/bad.png', 5000, 8 )">error test</button>
<textarea id="output" cols="80" rows="20"></textarea>
<h2>Links</h2>
<ul>
<li><a href="https://uupaa.hatenadiary.org/entry/20080413/1208067631">完全に状況を掌握した画像の遅延読み込みの実現</a></li>
<li><a href="http://uupaa.hatenablog.com/entry/2013/12/17/171809">お手軽に画像の読み込みをハンドリングする、今どきな方法</a></li>
</ul>
</body></html>